---
import '../styles/tailwind.css';
import { BASELINE, SITE_DESCRIPTION, SITE_TITLE } from '../config';

interface Props {
  title?: string;
  description?: string;
  lang?: 'fr' | 'en';
  currentPath?: string;
}

const { title, description, lang = 'fr', currentPath = '/' } = Astro.props;

const nav = lang === 'fr'
  ? [
      { href: '/', label: 'Accueil' },
      { href: '/a-propos', label: 'À propos' },
    ]
  : [
      { href: '/en/', label: 'Home' },
      { href: '/en/about', label: 'About' },
    ];

const languageSwitch = lang === 'fr'
  ? {
      label: 'English version',
      href: currentPath === '/a-propos' ? '/en/about' : '/en/',
    }
  : {
      label: 'Version française',
      href: currentPath === '/en/about' ? '/a-propos' : '/',
    };

const pageTitle = title ? `${title} • ${SITE_TITLE}` : `${SITE_TITLE} • ${BASELINE}`;
const metaDescription = description ?? SITE_DESCRIPTION;
---
<!doctype html>
<html lang={lang}>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{pageTitle}</title>
    <meta name="description" content={metaDescription} />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body
    class="min-h-screen bg-slate-950 text-slate-100 font-[Inter,system-ui,sans-serif] bg-[radial-gradient(circle_at_20%_20%,rgba(56,189,248,0.18),transparent_25%),radial-gradient(circle_at_80%_0%,rgba(99,102,241,0.18),transparent_35%)]"
  >
    <header class="sticky top-0 border-b border-white/10 bg-slate-950/80 backdrop-blur">
      <div class="mx-auto flex max-w-6xl flex-col gap-4 px-4 py-4 md:flex-row md:items-center md:justify-between">
        <a href={lang === 'fr' ? '/' : '/en/'} class="flex items-center gap-3 text-white">
          <span
            class="flex h-11 w-11 items-center justify-center rounded-xl bg-gradient-to-br from-cyan-400 to-sky-500 text-lg font-black tracking-[0.1em] text-slate-900 shadow-lg shadow-cyan-500/25"
            aria-hidden="true"
          >
            FM
          </span>
          <div class="leading-tight">
            <span class="block text-lg font-bold">{SITE_TITLE}</span>
            <span class="block text-sm font-medium text-slate-300">{BASELINE}</span>
          </div>
        </a>
        <nav class="md:ml-auto">
          <ul class="flex flex-wrap items-center gap-2">
            {nav.map((item) => (
              <li>
                <a
                  href={item.href}
                  class={`inline-flex items-center rounded-full px-3 py-2 text-sm font-semibold transition hover:text-white hover:ring-1 hover:ring-white/15 ${
                    item.href === currentPath
                      ? 'bg-white/10 text-white ring-1 ring-white/15'
                      : 'text-slate-300'
                  }`}
                >
                  {item.label}
                </a>
              </li>
            ))}
          </ul>
        </nav>
        <div>
          <a
            class="inline-flex items-center gap-2 rounded-full border border-white/10 px-3 py-2 text-sm font-semibold text-slate-200 transition hover:border-cyan-400/50 hover:text-white"
            href={languageSwitch.href}
          >
            <span class="h-2 w-2 rounded-full bg-cyan-400"></span>
            {languageSwitch.label}
          </a>
        </div>
      </div>
    </header>

    <main class="mx-auto max-w-6xl space-y-12 px-4 pb-16 pt-10">
      <slot />
    </main>

    <footer class="border-t border-white/10 bg-slate-950/90">
      <div class="mx-auto flex max-w-6xl flex-col gap-2 px-4 py-8 sm:flex-row sm:items-center sm:justify-between">
        <div>
          <strong class="block text-lg font-semibold text-white">{SITE_TITLE}</strong>
          <p class="text-sm text-slate-400">{BASELINE}</p>
        </div>
        <p class="text-sm text-slate-500">Site généré avec Astro & Netlify • TypeScript</p>
      </div>
    </footer>
  </body>
</html>
