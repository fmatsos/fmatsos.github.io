---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import Timeline from '../components/organisms/Timeline.astro';
import Link from '../components/atoms/Link.astro';
import Image from '../components/atoms/Image.astro';
import { curriculum } from '../data/curriculum';
import { links } from '../data/links';

const posts = (await getCollection('posts', ({ data }) => data.published && !data.draft && data.lang === 'fr'))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 3);

const dateFormatter = new Intl.DateTimeFormat('fr-FR', { day: 'numeric', month: 'long', year: 'numeric' });
---
<BaseLayout lang="fr" currentPath="/">
  <div class="space-y-16">
    <section>
      <article class="space-y-4">
        <h4 class="font-semibold text-black dark:text-white">
          Bonjour, je m'appelle Franck üëã
        </h4>
        <p>
          D√©veloppeur PHP depuis 2009, j'ai rejoint
          <Link href="https://www.akawaka.fr" external>Akawaka</Link>
          en 2021. Certifi√©
          <Link href="https://directory.opquast.com/fr/certificat/BVARDQ/" external>Opquast</Link>
          et
          <Link href="https://symfony.com/certification" external>Symfony</Link>.
        </p>
        <p>
          Apr√®s plusieurs ann√©es √† parcourir les r√©seaux sociaux, j'ai choisi de me concentrer sur ma famille, mon travail et mes lectures. Je partage ici mes r√©flexions et analyses sur le d√©veloppement Web.
        </p>
      </article>
    </section>

    <section class="border border-foreground/10 bg-background/70 p-6 dark:border-background-dark/30 dark:bg-background-dark/80 space-y-6">
      <div class="flex flex-wrap gap-y-2 items-center justify-between">
        <h5 class="font-semibold text-black dark:text-white">
          Derniers articles
        </h5>
        <Link href="/blog">Voir tous les articles ‚Üí</Link>
      </div>
      <ul class="space-y-4">
        {posts.map((post) => (
          <li class="space-y-1">
            <p class="text-sm text-foreground/60 dark:text-foreground-dark/60">
              <time datetime={post.data.pubDate.toISOString()}>
                {dateFormatter.format(post.data.pubDate)}
              </time>
            </p>
            <Link href={`/blog/${post.slug}`} class="font-semibold text-black dark:text-white">
              {post.data.title}
            </Link>
          </li>
        ))}
      </ul>
    </section>

    <section class="space-y-6">
      <h5 class="font-semibold text-black dark:text-white">
        Me contacter
      </h5>
      <ul class="space-y-3">
        {links.map((link) => (
          <li>
            <a
              class="flex items-center gap-3 group"
              href={link.href}
              target="_blank"
              rel="noreferrer noopener"
            >
              <Image src={link.picto} alt={link.alt} class="h-5 w-5" loading="lazy" />
              <span class="text-black dark:text-white group-hover:opacity-75">{link.title}</span>
            </a>
          </li>
        ))}
      </ul>
    </section>
  </div>
</BaseLayout>
