---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import PageHeader from '../components/organisms/PageHeader.astro';
import Link from '../components/atoms/Link.astro';

const posts = (await getCollection('posts', ({ data }) => data.published && !data.draft && data.lang === 'fr'))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 5);

const dateFormatter = new Intl.DateTimeFormat('fr-FR', { day: 'numeric', month: 'long', year: 'numeric' });
---
<BaseLayout lang="fr" currentPath="/">
  <div class="space-y-16">
    <PageHeader 
      title="Bonjour, je m'appelle Franck"
      subtitle="DÃ©veloppeur depuis 2009 â€“ CertifiÃ© Opquast et Symfony."
      description="PassionnÃ© par la crÃ©ation d'architectures logicielles solides et maintenables, j'aime explorer les diffÃ©rentes facettes du dÃ©veloppement web moderne. Mon parcours m'a permis de travailler sur des projets variÃ©s, du refactoring de systÃ¨mes legacy Ã  la conception de nouvelles applications."
      icon="ðŸ‘‹"
    />

    <section class="border border-foreground/10 bg-background/70 p-6 dark:border-background-dark/30 dark:bg-background-dark/80 space-y-6 animate-scale-in animate-delay-300">
      <div class="flex flex-wrap gap-y-2 items-center justify-between">
        <h3 class="text-2xl font-semibold text-black dark:text-white">
          Derniers articles
        </h3>
        <Link href="/blog">Voir tous les articles â†’</Link>
      </div>
      <ul class="space-y-4">
        {posts.map((post, index) => (
          <li class="space-y-1 animate-fade-in-up" style={`animation-delay: ${400 + index * 80}ms`}>
            <p class="text-muted">
              <time datetime={post.data.pubDate.toISOString()}>
                {dateFormatter.format(post.data.pubDate)}
              </time>
            </p>
            <Link href={`/blog/${post.slug}`} class="font-semibold text-black dark:text-white">
              {post.data.title}
            </Link>
          </li>
        ))}
      </ul>
    </section>
  </div>
</BaseLayout>
